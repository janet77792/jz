<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>捏合縮放測試</title>
  <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-gesture-detector@3.0.0/dist/aframe-gesture-detector.min.js"></script>
  <style>
    body, html { margin: 0; height: 100%; overflow: hidden; }
  </style>
</head>
<body>
  <a-scene gesture-detector>
    <a-entity id="box" geometry="primitive: box" material="color: orange" position="0 1.5 -3" 
              scale="1 1 1"
              gesture-handler>
    </a-entity>
    <a-camera position="0 1.6 0"></a-camera>
  </a-scene>

  <script>
    AFRAME.registerComponent('gesture-handler', {
      init: function () {
        this.initialScale = this.el.object3D.scale.clone();
        this.handleGestureStart = (e) => {
          if(e.target !== this.el) return;
          this.initialScale.copy(this.el.object3D.scale);
        };
        this.handleGestureChange = (e) => {
          if(e.target !== this.el) return;
          const scaleFactor = e.detail.scale;
          this.el.object3D.scale.set(
            this.initialScale.x * scaleFactor,
            this.initialScale.y * scaleFactor,
            this.initialScale.z * scaleFactor
          );
        };
        this.el.sceneEl.addEventListener('gesturestarted', this.handleGestureStart);
        this.el.sceneEl.addEventListener('gesturechanged', this.handleGestureChange);
      },
      remove: function () {
        this.el.sceneEl.removeEventListener('gesturestarted', this.handleGestureStart);
        this.el.sceneEl.removeEventListener('gesturechanged', this.handleGestureChange);
      }
    });
  </script>
</body>
</html>
